## 1. Попробуйте запустить playbook на окружении из test.yml, зафиксируйте какое значение имеет факт some_fact для указанного хоста при выполнении playbook'a.
````
some_fact: 12
````

ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ ansible-playbook site.yml -i inventory/test.yml

запускаем плейбук

````
PLAY [Print os facts] *************************************************************************************************************************************************************************************

TASK [Gathering Facts] ************************************************************************************************************************************************************************************
ok: [localhost]

TASK [Print OS] *******************************************************************************************************************************************************************************************
ok: [localhost] => {
    "msg": "Ubuntu"
}

TASK [Print fact] *****************************************************************************************************************************************************************************************
ok: [localhost] => {
    "msg": 12
}

PLAY RECAP ************************************************************************************************************************************************************************************************
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
````

## 2. Найдите файл с переменными (group_vars) в котором задаётся найденное в первом пункте значение и поменяйте его на 'all default fact'.

````
examp.yml #  ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook/group_vars/all$
````

## 3. Воспользуйтесь подготовленным (используется docker) или создайте собственное окружение для проведения дальнейших испытаний.

ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ docker run -d –name ubuntu pycontribs/ubuntu:latest sleep 600000 # поднять Ubuntu # запустить контейнер ubuntu

ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ docker run -d –name centos pycontribs/centos:7 sleep 600000 # поднять centos контейнер pycontribs # запустить контейнер centos

## 4.Проведите запуск playbook на окружении из prod.yml. Зафиксируйте полученные значения some_fact для каждого из managed host.

````
ansible-playbook site.yml -i inventory/prod.yml
````
Фиксируем значения
````
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ ansible-playbook site.yml -i inventory/prod.yml --ask-vault-pass
Vault password: 

PLAY [Print os facts] *************************************************************************************************************************************************************************************

TASK [Gathering Facts] ************************************************************************************************************************************************************************************
ok: [localhost]
[DEPRECATION WARNING]: Distribution Ubuntu 18.04 on host ubuntu should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release
 will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information. This feature will be 
removed in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
ok: [ubuntu]
ok: [centos]

TASK [Print OS] *******************************************************************************************************************************************************************************************
ok: [localhost] => {
    "msg": "Ubuntu"
}
ok: [ubuntu] => {
    "msg": "Ubuntu"
}
ok: [centos] => {
    "msg": "CentOS"
}

TASK [Print fact] *****************************************************************************************************************************************************************************************
ok: [localhost] => {
    "msg": "hello"
}
ok: [centos] => {
    "msg": "el default fact"
}
ok: [ubuntu] => {
    "msg": "deb default fact"
}

PLAY RECAP ************************************************************************************************************************************************************************************************
centos                     : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
ubuntu                     : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
````

## 5. Добавьте факты в group_vars каждой из групп хостов так, чтобы для some_fact получились следующие значения: для deb - 'deb default fact', для el - 'el default fact'.

````
ok: [centos] => {
    "msg": "el default fact"
}
ok: [ubuntu] => {
    "msg": "deb default fact"
}
````

## 7. При помощи ansible-vault зашифруйте факты в group_vars/deb и group_vars/el с паролем netology.

````
ansible-vault encrypt ~/ansible/playbook/group_vars/deb/examp.yml# зашифровать файл
````

````
ansible-vault encrypt ~/ansible/playbook/group_vars/el/examp.yml
````

## 8.Запустите playbook на окружении prod.yml. При запуске ansible должен запросить у вас пароль. Убедитесь в работоспособности.

Запустите playbook на окружении prod.yml. При запуске ansible должен запросить у вас пароль. Убедитесь в работоспособности.
````
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ ansible-playbook site.yml -i inventory/prod.yml --ask-vault-pass
````

## 9. Посмотрите при помощи ansible-doc список плагинов для подключения. Выберите подходящий для работы на control node.

````
ansible-doc -t connection ssh
````

## 10. В prod.yml добавьте новую группу хостов с именем local, в ней разместите localhost с необходимым типом подключения.

````
---
  el:
    hosts:
      centos:
        ansible_connection: docker
  deb:
    hosts:
      ubuntu:
        ansible_connection: docker
  local:
    hosts:
      localhost:
        ansible_connection: local
````

## 11. Запустите playbook на окружении prod.yml. При запуске ansible должен запросить у вас пароль. Убедитесь что факты some_fact для каждого из хостов определены из верных group_vars.

````
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ ansible-playbook site.yml -i inventory/prod.yml --ask-vault-pass
Vault password: 

PLAY [Print os facts] *************************************************************************************************************************************************************************************

TASK [Gathering Facts] ************************************************************************************************************************************************************************************
ok: [localhost]
[DEPRECATION WARNING]: Distribution Ubuntu 18.04 on host ubuntu should use /usr/bin/python3, but is using /usr/bin/python for backward compatibility with prior Ansible releases. A future Ansible release
 will default to using the discovered platform python for this host. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html for more information. This feature will be 
removed in version 2.12. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
ok: [ubuntu]
ok: [centos]

TASK [Print OS] *******************************************************************************************************************************************************************************************
ok: [localhost] => {
    "msg": "Ubuntu"
}
ok: [centos] => {
    "msg": "CentOS"
}
ok: [ubuntu] => {
    "msg": "Ubuntu"
}

TASK [Print fact] *****************************************************************************************************************************************************************************************
ok: [localhost] => {
    "msg": "hello"
}
ok: [centos] => {
    "msg": "el default fact"
}
ok: [ubuntu] => {
    "msg": "deb default fact"
}

PLAY RECAP ************************************************************************************************************************************************************************************************
centos                     : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
localhost                  : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
ubuntu                     : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0  
````

=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----=====----

# Самоконтроль выполненения задания

1. Где расположен файл с `some_fact` из второго пункта задания?
``` 
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook/group_vars/all
```

2. Какая команда нужна для запуска вашего `playbook` на окружении `test.yml`?
   
````
ansible-playbook site.yml -i inventory/test.yml
````

3. Какой командой можно зашифровать файл?
````
ansible-vault encrypt ~/ansible/playbook/group_vars/deb/examp.yml# зашифровать файл
````

````
ansible-vault encrypt ~/ansible/playbook/group_vars/el/examp.yml
````

4. Какой командой можно расшифровать файл?
````
ansible-vault decrypt ~/ansible/playbook/group_vars/deb/examp.yml
````

````
ansible-vault decrypt ~/ansible/playbook/group_vars/el/examp.yml 
````

5. Можно ли посмотреть содержимое зашифрованного файла без команды расшифровки файла? Если можно, то как?

````
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook/group_vars/deb$ ansible-vault view examp.yml
````

6. Как выглядит команда запуска `playbook`, если переменные зашифрованы?
````
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ ansible-playbook site.yml -i inventory/prod.yml --ask-vault-pass
````


7. Как называется модуль подключения к host на windows?
````
WinRM - это протокол управления, используемый Windows для удаленного взаимодействия с другим сервером. Это протокол на основе SOAP, который обменивается данными через HTTP / HTTPS и включен во все последние операционные системы Windows. Начиная с Windows Server 2012 WinRM включен по умолчанию, но в большинстве случаев для использования WinRM с Ansible требуется дополнительная настройка.
````
8. Приведите полный текст команды для поиска информации в документации ansible для модуля подключений ssh
````
ubuntusql@ubuntusql-VirtualBox:~/ansible/playbook$ ansible-doc -t connection -l # # выведи справку тип плагина -t connection  покажи список со всеми плагинами connction -l
````
````
ansible-doc -t connection ssh
````

9. Какой параметр из модуля подключения `ssh` необходим для того, чтобы определить пользователя, под которым необходимо совершать подключение?

[нашел по ссылке](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/ssh_connection.html) 
````
remote_user
````
