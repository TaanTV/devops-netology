

# Домашнее задание к занятию "10.06. Инцидент-менеджмент"

## Задание 1

Составьте постмотрем, на основе реального сбоя системы Github в 2018 году.

Информация о сбое доступна [в виде краткой выжимки на русском языке](https://habr.com/ru/post/427301/) , а
также [развёрнуто на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).




# Post-incident analysis 

## Краткое описание инцидента

21 октября в 22:52 по Гринвичу плановые работы по техническому обслуживанию по замене вышедшего из строя оптического оборудования, что привело  к потере связи между нашим сетевым центром на восточном побережье США и нашим основным центром обработки данных на восточном побережье США.

## Предшествующие события

21 октября в 22:52 по Гринвичу плановые работы по техническому обслуживанию по замене вышедшего из строя оптического оборудования 100G

## Причина инцидента

Возникла потеря связи между нашим сетевым центром на восточном побережье США и нашим основным центром обработки данных на восточном побережье США.

## Воздействие

В течение 24 часов и 11 минут у 100% пользователей: было невозможно создать issue, оставить комментарий, не работали хуки и сайты на GitHub Pages

## Обнаружие

Сработал мониторинг и инцидент был замечен инженерами дежурными инженерами GitHub.

## Рекция

Сервис был полностью восстановлен за 24 часа 11 минут

## Восстановление

БД в дата центре на Восточном побережье была восстановлена из бэкапа, вручную сконфигурирована как primary для всех кластеров и топология репликации была перестроена. Пользовательские данные не пострадали.

## Таймлайн

* 21 октября 2018 22:54 UTC системы мониторинга начали генерировать предупреждения

* 23:02 по Гринвичу инженеры определили,  что система находится в некорректном состоянии. 

* 2018 21 октября 23:07 UTC
Заблокировали наши внутренние инструменты развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений.
  
* 2018 21 октября 23:09 по всемирному координированному времени команда ответивших поместила сайт в желтый статус .

* 23:11 UTC подключился координатор инцидента и через две минуты принял решение изменить статус на красный .

* 21 октября 2018 г., 23:13 UTC Команде решающей инцидент стало понятно, что проблема затронула несколько кластеров БД. Все сервисы переведены в режим read-only для восстановления работоспособности

* 21 Октября 2018 23:19 UTC
Останавливаем доставку веб-перехватчиков и сборки GitHub Pages, чтобы не потерять данные полученные от пользователей.
  
* 22 октября 2018, 00:05 UTC
Принято решение восстановить базу из бэкапа и провести синхронизацию кластера
  
* 22 октября 2018 г., 00:41 UTC
Запущен процесс резервного копирования всех затронутых кластеров MySQL
  
* 2018 22 Октября 06:51 UTC
Несколько кластеров завершили восстановление из резервных копий в нашем центре обработки данных на восточном побережье США и начали репликацию новых данных с западного побережья.
  
* 2018 22 Октября 07:46 UTC
GitHub опубликовал сообщение в блоге, с извинениями. 

* 22 октября 2018, 11:12 UTC
Все первичные БД снова восстановлены на Восточном побережье США. Распределили нагрузку чтения по большому пулу реплик чтения.
  
* 2018 22 октября 13:15 UTC
Задержки репликации увеличивались, а не уменьшались в сторону согласованного состояния. Подключаем дополнительные реплики чтения MySQL в общедоступном облаке Восточного побережья США.

* 22 октября 2018 г., 16:24 UTC
Реплики синхронизировались. Выполнили аварийное переключение на исходную топологию.
  
* 22 октября 2018 г., 16:45 UTC
Начинаем обработку накопившихся веб хуков.
  
* 2018 Октябрь 22 23:03 UTC
Восстановили статус сервиса в штатный режим.
  
## Последующие действия

1) Настроить конфигурацию Orchestrator, чтобы предотвратить продвижение основных параметров базы данных через региональные границы. 

2) Ускорить переход к новому механизму отчетности о статусе

3) Провести проверки системы:
выдержать полный отказ одного центра обработки данных без воздействия на пользователя.

4) Понимание что существующих механизмов обеспечивающих бесперебойную работу не достаточно, требуется повышения качества.
















