# Домашнее задание к занятию "11.02 Микросервисы: принципы"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

### Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- Маршрутизация запросов к нужному сервису на основе конфигурации
- Возможность проверки аутентификационной информации в запросах
- Обеспечение терминации HTTPS

Обоснуйте свой выбор.

Ответ:

### Лучшим считается Nginx




Основная функция шлюза API - предоставить единую согласованную точку входа для нескольких API, независимо от того, как они реализованы или развернуты на сервере. Не все API-интерфейсы являются приложениями микросервисов. Нашему шлюзу API необходимо управлять существующими API, монолитами и приложениями, частично переходящими на микросервисы.
У все API Gateway принцип такой: идет запрос в систему- попадает во врата APIGateway и там уже по настройкам конфигов летит в нужное место.Но это же место является единой точкой отказа.

Nginx
Клиентское приложение отправляет HTTP- GET запрос в / api / inventory / inventory .

![https://raw.githubusercontent.com/TaanTV/devops-netology/main/Netology%20dz/Kubernetes%20administration%20and%20configuration/Homework%20for%20the%20lesson%2011.02%20Microservices%20principles/nginx%20gateway%20Homework%20for%20the%20lesson%2011.02%20Microservices%20principles%20.jpg](https://raw.githubusercontent.com/TaanTV/devops-netology/main/Netology%20dz/Kubernetes%20administration%20and%20configuration/Homework%20for%20the%20lesson%2011.02%20Microservices%20principles/nginx%20gateway%20Homework%20for%20the%20lesson%2011.02%20Microservices%20principles%20.jpg)

Одним из преимуществ использования NGINX в качестве шлюза API является то, что он может выполнять эту роль, одновременно выступая в качестве обратного прокси, балансировщика нагрузки и веб-сервера для существующего HTTP-трафика. Если NGINX уже является частью стека доставки вашего приложения, обычно нет необходимости в развертывании отдельного шлюза API.

Amazon API Gateway — 

Документация включает подробные инструкции — от развёртывания RESTful API при создании бессерверного веб-приложения до работы с HTTP API, поэтому не придётся искать примеры по всей Сети, чтобы разобраться.
Особенности:

* Создание API RESTful при помощи API HTTP или API REST.
* Интерфейсы API WebSocket для разработки приложений, которым требуется двусторонняя связь в режиме реального времени.
*  Частная интеграция с AWS ELB и AWS CloudMap.
*  Ключи API для сторонних разработчиков.
*  Генерирование клиентских SDK на многих языках, включая JavaScript, iOS и Android.
*  Внедрение подписи четвёртой версии для API REST и API WebSocket при авторизации и проверке запросов API к другим сервисам AWS API Gateway.
*  Авторизация с помощью AWS Lambda.
*  Amazon API Gateway можно пользоваться бесплатно целый год — пока ваши потребности не превышают один миллион вызовов API, полученных для API REST, один миллион вызовов API, полученных для API HTTP, и один миллион сообщений и 750 000 минут подключения для API WebSocket в месяц.

Здесь приведена архитектура для типичного SaaS-провайдера, который предлагает свои услуги другим организациям и должен поддерживать “white-label”-домены для веб- и API — инфраструктуры.

![https://raw.githubusercontent.com/TaanTV/devops-netology/main/Netology%20dz/Kubernetes%20administration%20and%20configuration/Homework%20for%20the%20lesson%2011.02%20Microservices%20principles/Amazon%20gateway%20Homework%20for%20the%20lesson%2011.02%20Microservices%20principles%20.jpg](https://raw.githubusercontent.com/TaanTV/devops-netology/main/Netology%20dz/Kubernetes%20administration%20and%20configuration/Homework%20for%20the%20lesson%2011.02%20Microservices%20principles/Amazon%20gateway%20Homework%20for%20the%20lesson%2011.02%20Microservices%20principles%20.jpg)

### Google API Gateway

Ниже представлена высокоуровневая диаграмма основных компонентов, задействованных в API Gateway



•  Поставщик API отвечает за создание и развертывание API на шлюзе API. Каждый API определяется файлом, написанным как спецификация OpenAPI 2.0.
Спецификация OpenAPI определяет общедоступный URL-адрес конечной точки REST для API, серверную службу, к которой обращается API, и любые другие характеристики API, такие как аутентификация, формат данных и параметры ответа.

•  Клиент API делает запрос REST к API, размещенному на шлюзе API, для доступа к серверным службам. Клиент API может быть любым приложением, способным выполнять вызов REST, например браузером, мобильным приложением или веб-приложением.
Клиент API только должен знать URL в API, запрос глаголом (например GET, PUT, POST, DELETE), любые требования аутентификации и формат любых данных , отправленных или полученных от API.
Клиенту API не нужно ничего знать о внутренней реализации. Фактически, один API, размещенный на API Gateway, может быть настроен для доступа к различным серверным модулям на основе информации, переданной в запросе.

![https://raw.githubusercontent.com/TaanTV/devops-netology/main/Netology%20dz/Kubernetes%20administration%20and%20configuration/Homework%20for%20the%20lesson%2011.02%20Microservices%20principles/google%20gateway%20Homework%20for%20the%20lesson%2011.02%20Microservices%20principles%20%20%E2%80%94%20.jpg](https://raw.githubusercontent.com/TaanTV/devops-netology/main/Netology%20dz/Kubernetes%20administration%20and%20configuration/Homework%20for%20the%20lesson%2011.02%20Microservices%20principles/google%20gateway%20Homework%20for%20the%20lesson%2011.02%20Microservices%20principles%20%20%E2%80%94%20.jpg)



## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- Поддержка кластеризации для обеспечения надежности
- Хранение сообщений на диске в процессе доставки
- Высокая скорость работы
- Поддержка различных форматов сообщений
- Разделение прав доступа к различным потокам сообщений
- Протота эксплуатации

Обоснуйте свой выбор.

Ответ: 

Брокеры сообщений на облачных вендорах лучше не завязываться, лучше всего использовать kafka, rebbitMQ.



Если стоит задача - доставить сообщение первому попавшемуся потребителю, то выбор RabbitMQ.

### Kafka

### RabbitMQ







